<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Anime Template" />
    <meta name="keywords" content="Anime, unica, creative, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Gaming Library</title>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <!-- Css Styles -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="css/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="css/plyr.css" type="text/css" />
    <link rel="stylesheet" href="css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="css/style.css" type="text/css" />
  </head>

  <body>
    <!-- Page Preloder -->
    <div id="preloder">
      <div class="loader"></div>
    </div>

    <!-- Header Section Begin -->
    <header class="header">
      <div class="container">
        <div class="row">
          <div class="col-lg-2">
            <div class="header__logo">
              <a href="./index.html">
                <img src="img/logo.png" alt="" />
              </a>
            </div>
          </div>
          <div class="col-lg-8">
            <div class="header__nav">
              <nav class="header__menu mobile-menu">
                <ul>
                  <li class="active"><a href="./index.html">Homepage</a></li>
                  <li>
                    <a href="#"
                      >Minijuegos <span class="arrow_carrot-down"></span
                    ></a>
                    <ul class="dropdown">
                      <li>
                        <a
                          href="games/flappyBird/flappyBird.html"
                          target="_blank"
                          >Flappy Bird</a
                        >
                      </li>
                      <li>
                        <a href="games/Doodle Jump/index.html" target="_blank"
                          >Doodle Jump</a
                        >
                      </li>
                      <li>
                        <a href="games/OX Juego/index.html" target="_blank"
                          >OX</a
                        >
                      </li>
                      <li>
                        <a href="games/tetris/index.html" target="_blank"
                          >Tetris</a
                        >
                      </li>
                      <li>
                        <a href="games/Snake/index.html" target="_blank"
                          >Snake</a
                        >
                      </li>
                    </ul>
                  </li>
                  <li><a href="aboutme.html" target="_blank">Sobre mi</a></li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
        <div id="mobile-menu-wrap"></div>
      </div>
    </header>
    <!-- Header End -->

    <!-- Breadcrumb Begin -->
    <div class="breadcrumb-option">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <div class="breadcrumb__links">
              <a href="./index.html"><i class="fa fa-home"></i> Home</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Breadcrumb End -->

    <!-- Anime Section Begin -->
    <section class="anime-details spad">
      <div class="container">
        <div class="anime__details__content">
          <div class="row">
            <div class="col-lg-3">
              <div id="game-logo" class="anime__details__pic set-bg"></div>
            </div>
            <div class="col-lg-9">
              <div class="anime__details__text">
                <div class="anime__details__title">
                  <h3 id="game-name" style="font-size: 25px"></h3>
                  <span id="game-company"></span>
                </div>
                <div
                  class="anime__details__rating"
                  id="game-metacritic-score"
                ></div>

                <p id="game-description"></p>

                <div class="anime__details__widget">
                  <div class="row">
                    <div class="col-lg-6 col-md-6">
                      <ul>
                        <li id="game-release"><span>:</span></li>
                        <li id="game-developer"><span></span></li>
                        <li id="game-website"><span></span></li>
                        <li id="game-platforms"><span></span></li>
                      </ul>
                    </div>
                    <div class="col-lg-6 col-md-6">
                      <ul>
                        <li id="game-genres"><span></span></li>

                        <li id="game-publisher"><span></span></li>

                        <li id="game-age-rate"><span></span></li>
                        <li id="game-stores"><span></span></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="container">
              <div style="color: white; text-align: center; font-size: 30px">
                Capturas de Pantalla:
              </div>
              <br />
            </div>
          </div>
          <!--Carrusel-->
          <!--Carrusel-->

          <div id="carouselExample" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner"></div>
            <button
              class="carousel-control-prev"
              type="button"
              data-target="#carouselExample"
              data-slide="prev"
            >
              <span
                class="carousel-control-prev-icon"
                aria-hidden="true"
              ></span>
              <span class="visually-hidden"></span>
            </button>
            <button
              class="carousel-control-next"
              type="button"
              data-target="#carouselExample"
              data-slide="next"
            >
              <span
                class="carousel-control-next-icon"
                aria-hidden="true"
              ></span>
              <span class="visually-hidden"></span>
            </button>
          </div>
        </div>
      </div>
    </section>
    <!-- Anime Section End -->

    <!-- Footer Section Begin -->
    <footer class="footer">
      <div class="page-up">
        <a href="#" id="scrollToTopButton"
          ><span class="arrow_carrot-up"></span
        ></a>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-lg-3">
            <div class="footer__logo">
              <a href="./index.html"><img src="img/logo.png" alt="" /></a>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="footer__nav">
              <ul>
                <li class="active"><a href="./index.html">Homepage</a></li>

                <li><a href="#">Minijuegos</a></li>
                <li><a href="#">Sobre mi</a></li>
              </ul>
            </div>
          </div>
          <div class="col-lg-3">
            <p>
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
              Copyright &copy;
              <script>
                document.write(new Date().getFullYear());
              </script>
              All rights reserved | This template is made with
              <i class="fa fa-heart" aria-hidden="true"></i> by Sainz
              <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
          </div>
        </div>
      </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Search model Begin -->
    <div class="search-model">
      <div class="h-100 d-flex align-items-center justify-content-center">
        <div class="search-close-switch"><i class="icon_close"></i></div>
        <form class="search-model-form">
          <input type="text" id="search-input" placeholder="Search here....." />
        </form>
      </div>
    </div>
    <!-- Search model end -->

    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/player.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/mixitup.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
<script>
  $(document).ready(function () {
    let getDetail = () => {
      let urlParams = window.location.toString().split("?")[1];

      let id = urlParams.split("=")[1];

      const url = `https://api.rawg.io/api/games/${id}?key=43d750c7481748f99dabb07d5e8aa4eb`;

      const data = {};

      fetch(url, {
        method: "GET", // or 'PUT'
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((response) => response.json())
        .then((data) => {
          console.log(data);
          let year = data.released.split("-")[0];

          //Guardando el valor del score en metacritic
          let scoreMeta = data.metacritic;
          //Mostrando en la etiqueta obtenida por el id
          $("#game-name").html(`${data.name} (${year})`);
          //Mostrando compania
          $("#game-company").html(
            `<p style=font-size:30px;color:#e53637>${data.publishers[0].name}</p>`
          );

          //Mostrando fecha de lanzamiento
          $("#game-release").html(`<span>Lanzamiento:</span> ${data.released}`);
          //Mostrando generos del juego
          const genres = data.genres.map((genre) => genre.name).join(", ");
          $("#game-genres").html(`<span>Genero:</span> <u>${genres}</u>`);
          //Mostrando desarrolladores del juego
          const developers = data.developers
            .map((developer) => developer.name)
            .join(", ");
          $("#game-developer").html(
            `<span>Desarrolladora:</span> ${developers}`
          );
          //Mostrando distribuidor del juego
          const publishers = data.publishers
            .map((publisher) => publisher.name)
            .join(", ");

          $("#game-publisher").html(
            `<span>Distribuidora:</span> ${publishers}`
          );
          //Mostrando plataformas
          const platforms = data.platforms
            .map((platform) => platform.platform.name)
            .join(",");
          $("#game-platforms").html(`<span>Plataformas:</span> ${platforms}`);
          //Mostrando calificacion de edad
          $("#game-age-rate").html(
            `<span>Calif edad:</span> ${data.esrb_rating.name}`
          );

          //Mostrando Website oficial
          $("#game-website").html(
            `<span>Sitio Web: </span> <a href= "${data.website}" target="_blank" class="my-link">${data.website}</a>`
          );
          //Mostrando tiendas para comprar
          const stores = data.stores.map((store) => {
            const storeName = store.store.name;
            let storeUrl = store.store.domain;
            if (storeUrl.startsWith("http")) {
              storeUrl = storeUrl.replace(/(^\w+:|^)\/\//, "");
            }
            return `<a href="https://${storeUrl}" target="_blank" class="my-link">${storeName}</a>`;
          });
          $("#game-stores").html(`<span>Tiendas:</span> ${stores.join(", ")}`);
          //Condicional para el color de la caja de calificacion

          const classMetacritic =
            scoreMeta >= 75 ? "green" : scoreMeta >= 50 ? "yellow" : "red";

          $("#game-metacritic-score").html(
            `<div class="box ${classMetacritic}">${scoreMeta}/100<br/> <p style='font-size:30px'></p></div>`
          );

          // if (scoreMeta >= 75) {
          //   $("#game-metacritic-score").html(
          //     `<div class="box green">${scoreMeta}/100<br/> <p style='font-size:30px'></p></div>`
          //   );
          // } else if (scoreMeta >= 50) {
          //   $("#game-metacritic-score").html(
          //     `<div class="box yellow">${scoreMeta}/100</div>`
          //   );
          // } else {
          //   $("#game-metacritic-score").html(
          //     `<div class="box red">${scoreMeta}/100</div>`
          //   );
          //}
          $("#game-description").html(
            `Sobre el juego:  <p style="color:white;">${data.description}</p>`
          );
        })
        .catch((error) => {
          console.error("Error:", error);
        });
      if (
        $("#game-description")[0].scrollHeight >
        $("#game-description").outerHeight()
      ) {
        $("show-more").show();
      }
      $("#show-more").click(function () {
        $("#game-description").css("max-height", "none");
        $(this).hide();
      });
    };

    getDetail();
  });
</script>

<script>
  //Mostrar Imagen Videojuego
  let urlParams = window.location.toString().split("?")[1];

  let id = urlParams.split("=")[1];
  $.ajax({
    url: `https://api.rawg.io/api/games/${id}?key=43d750c7481748f99dabb07d5e8aa4eb`,
    method: "GET",
    success: function (response) {
      const imageUrl = response.background_image;
      $("#game-logo").css("background-image", `url(${imageUrl})`);
    },
    error: function (error) {
      console.log(error);
    },
  });
</script>
<script>
  //Carrusel

  // Obtener las imágenes del carrusel
  $.get(
    `https://api.rawg.io/api/games/${id}/screenshots?key=43d750c7481748f99dabb07d5e8aa4eb`,
    function (response) {
      const carouselInner = $("#carouselExample .carousel-inner");

      // Recorrer los resultados de la API y agregarlos al carrusel
      for (let i = 0; i < response.results.length; i++) {
        const screenshot = response.results[i];
        const screenshotUrl = screenshot.image;
        const screenshotAlt = screenshot.name || `Screenshot ${i + 1}`;

        // Crear el elemento de la imagen y agregarlo al carrusel
        const carouselItem = $("<div>").addClass("carousel-item");
        const img = $("<img>")
          .attr("src", screenshotUrl)
          .attr("alt", screenshotAlt)
          .addClass("d-block w-100");
        carouselItem.append(img);
        carouselInner.append(carouselItem);
      }

      // Agregar la clase "active" al primer elemento del carrusel
      $("#carouselExample .carousel-item").first().addClass("active");

      // Inicializar el carrusel
      $("#carouselExample").carousel();
    }
  );
</script>

<!--Estilo de las cajas de puntuacion de Metacritic-->
<style>
  .box {
    display: inline-block;
    padding: 5px 15px 0px; /* Agregamos 3px de padding inferior */
    margin: 2px;
    border-radius: 5px;
    color: #fff;
    font-weight: bold;
    font-size: 40px;
  }

  .green {
    background-color: #2ecc71;
  }
  .yellow {
    background-color: #f1c40f;
  }
  .red {
    background-color: #e74c3c;
  }
</style>
<style>
  #game-description p {
    color: white;
  }
  .my-link:visited {
    color: #007bff;
    text-decoration: none;
    cursor: pointer;
  }
  .my-link:hover {
    color: red;
    text-decoration: underline;
    cursor: pointer;
  }
  .carousel-control-prev,
  .carousel-control-next {
    background: transparent;
    border: none;
  }
</style>
